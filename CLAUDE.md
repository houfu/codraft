# Codraft — Project Instructions

Codraft is a document assembly tool built as Claude Cowork skills. It replaces traditional document automation platforms by using Claude to interview the user, collect variable values, and produce completed documents from templates.

## How It Works

1. User asks to prepare a document (e.g., "prepare an NDA")
2. Claude matches the request to a template in `templates/`
3. The template is analyzed for `{{ variable_name }}` placeholders
4. Claude interviews the user conversationally, grouping related fields
5. Once confirmed, the template is rendered and saved to a job folder in `output/`

Templates can be `.docx` or `.html`:
- **docx** → rendered via `docxtpl` → produces `.docx`
- **html** → rendered via `jinja2` → produces `.html` + `.pdf` (via `weasyprint`)

## Project Structure

```
codraft/
├── CLAUDE.md              # This file — project-level instructions
├── README.md              # Project documentation
├── codraft_mvp_spec.md    # Full MVP specification
├── LICENSE                # MIT License
├── .gitignore
├── .claude/
│   └── skills/
│       └── codraft/
│           └── SKILL.md   # The orchestrator skill (main entry point)
├── templates/
│   ├── _examples/         # Bundled example templates (tracked in git)
│   │   └── nda/
│   │       └── nda.docx
│   └── <user_template>/   # User templates (gitignored)
│       ├── <name>.docx or <name>.html
│       └── manifest.yaml  # Auto-generated (gitignored)
└── output/                # Rendered documents (gitignored)
    └── <job_name>/        # One folder per rendering job
```

## Key Conventions

### Templates
- Example templates live in `templates/_examples/` (tracked in git)
- User templates live in `templates/<name>/` (gitignored)
- The directory name is the template identifier (used for matching user intent)
- Each directory contains one template file: either `.docx` or `.html` (not both)
- Templates use `{{ variable_name }}` Jinja2-style placeholders
- `manifest.yaml` is auto-generated by the Analyzer — do not edit manually
- The Analyzer only regenerates the manifest if the template file is newer than the existing manifest

### Output
- Each rendering job gets its own folder in `output/`
- Job folder naming: `{template_name}_{key_variable}_{date}/`
- Docx jobs produce one file; HTML jobs produce both `.html` and `.pdf`

### Template Engines
- **docx**: Always use `docxtpl` (not raw python-docx) — preserves formatting around variables
- **html**: Use `jinja2` for rendering, `weasyprint` for PDF conversion
- Install via: `uv pip install docxtpl pyyaml jinja2 weasyprint`

### Python Environment
- Use `uv` for all Python environment and package management
- Format Python code in the style of `black`

## MVP Scope

The MVP supports **simple variable substitution only**:
- `{{ variable_name }}` placeholders — no conditionals, loops, or computed fields
- Flat template directory (each template in its own subdirectory)
- Type inference from variable name suffixes (e.g., `*_date` → date, `*_amount` → number)

## When Working on This Project

- Read `codraft_mvp_spec.md` for the full specification
- Read `.claude/skills/codraft/SKILL.md` for the skill implementation details
- The orchestrator skill is the main entry point — it contains analyzer and renderer logic inline
- Test templates should be placed in `templates/` with their own subdirectory
- All rendered output goes to `output/` — never overwrite templates
